<div class="panel panel-default" ng-controller="moduleController">
	<div ng-show="saveFailure" class="alert alert-danger">{{ resourceBundle.errorModule }}</div>
	<div class="panel-heading">
		<h3 class="panel-title">Module Details</h3>
		<div class="actions">
			<button class="btn btn-add btn-xs" ng-click="addModules()" ng-if="isEditMode">Add Module</button>
		</div>
	</div>
	<div class="panel-body">
		<form class="form-horizontal" name="form" role="form" ng-submit="save(modules)" novalidate>
			<div class="well" ng-repeat="module in modules">
				<button class="btn-delete" ng-hide="$first" ng-click="delete($index)">X Delete</button>
				<ul>
					<li>
						<label for="moduleName" class="col-sm-4 col-md-4 control-label">Add module</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" name="moduleName" id="moduleName" placeholder="Module Name" ng-model="module.name"  ng-disabled="!isEditMode" required>
							<div ng-show="form.moduleName.$dirty &amp;&amp; form.moduleName.$invalid">
								<span class="errortxt">{{resourceBundle.nameValidation}}</span>
							</div>
						</div>
					</li>
					<li class="form-group">
						<div class="col-sm-offset-2 col-sm-10">
							<div class="add-item-ctrl">
								<div ng-show="areDatasetsNotSelected([module])">
									<span>{{resourceBundle.selectDatasets}}</span>
								</div>
								<multiselect left-list="module.allDatasets" name="name" ng-model="module.datasets" ng-disabled="!isEditMode" click="displayGroupedDataElements(element)"></multiselect>
							</div>
							<div ng-repeat="section in selectedDataset.sections">
								<div class="collapse-head" style="position:relative">
									<h5 ng-click="isCollapsed = !isCollapsed" style="background:#ccc;display:block;padding:10px;cursor:pointer;">{{section.name}} </h5>
									<input type="checkbox" style="position:absolute;right:10px; top:7px;">
								</div>
								<div collapse="isCollapsed">
									<ul>
										<li ng-repeat="element in section.dataElements">
											<label>
												<input type="checkbox"> {{element.formName}}
											</label>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</li>
				</ul>
			</div>
			<button class="btn btn-main pull-right" ng-disabled="form.$invalid || areDatasetsNotSelected(modules)" ng-if="isEditMode">Save</button>
		</form>
		
	</div>
</div>